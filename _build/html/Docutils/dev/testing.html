

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Docutils Testing &mdash; American Academy of Orthopaedic Surgeons</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/Sorting_Directions.css" type="text/css" />
  

  

  
    <link rel="top" title="American Academy of Orthopaedic Surgeons" href="../../index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>
  <script src="../../_static/js/tsorter.min.js"></script>
  <script src="../../_static/js/list.js"></script>
  <script src="../../_static/js/jquery-2.2.4.min.js"></script>


</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> AAOS
          

          
          </a>

          
            
            
              <div class="version">
                1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../AAOS-Templates/index.html">AAOS Templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Applications-Software-Guides/index.html">Applications / Software Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Departments/index.html">Departments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Design-and-Style/index.html">Design and Style</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Committees/index.html">Committees</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Contribute/index.html">Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Governance/index.html">Governance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Project-Management-Office/index.html">Project Management Office</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Service-Desk/index.html">Service Desk</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Docutils Project Documentation Overview</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">AAOS</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
    <li>Docutils Testing</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="docutils-testing">
<h1><a class="reference external" href="http://docutils.sourceforge.net/">Docutils</a> Testing<a class="headerlink" href="#docutils-testing" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Authors:</th><td class="field-body">Lea Wiemann &lt;<a class="reference external" href="mailto:LeWiemann&#37;&#52;&#48;gmail&#46;com">LeWiemann<span>&#64;</span>gmail<span>&#46;</span>com</a>&gt;;
David Goodger &lt;<a class="reference external" href="mailto:goodger&#37;&#52;&#48;python&#46;org">goodger<span>&#64;</span>python<span>&#46;</span>org</a>&gt;</td>
</tr>
<tr class="field-even field"><th class="field-name">Revision:</th><td class="field-body">$Revision$</td>
</tr>
<tr class="field-odd field"><th class="field-name">Date:</th><td class="field-body">$Date$</td>
</tr>
<tr class="field-even field"><th class="field-name">Copyright:</th><td class="field-body">This document has been placed in the public domain.</td>
</tr>
</tbody>
</table>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#docutils-testing" id="id5">Docutils Testing</a><ul>
<li><a class="reference internal" href="#running-the-test-suite" id="id6">Running the Test Suite</a></li>
<li><a class="reference internal" href="#python-versions" id="id7">Python Versions</a></li>
<li><a class="reference internal" href="#unit-tests" id="id8">Unit Tests</a><ul>
<li><a class="reference internal" href="#writing-new-tests" id="id9">Writing New Tests</a></li>
</ul>
</li>
<li><a class="reference internal" href="#functional-tests" id="id10">Functional Tests</a><ul>
<li><a class="reference internal" href="#directory-structure" id="id11">Directory Structure</a></li>
<li><a class="reference internal" href="#the-testing-process" id="id12">The Testing Process</a></li>
<li><a class="reference internal" href="#creating-new-tests" id="id13">Creating New Tests</a></li>
<li><a class="reference internal" href="#the-default-configuration-file" id="id14">The Default Configuration File</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<p>When adding new functionality (or fixing bugs), be sure to add test
cases to the test suite.  Practise test-first programming; it&#8217;s fun,
it&#8217;s addictive, and it works!</p>
<p>This document describes how to run the Docutils test suite, how the
tests are organized and how to add new tests or modify existing tests.</p>
<div class="section" id="running-the-test-suite">
<h2><a class="toc-backref" href="#id6">Running the Test Suite</a><a class="headerlink" href="#running-the-test-suite" title="Permalink to this headline">¶</a></h2>
<p>Before checking in any changes, run the entire Docutils test suite to
be sure that you haven&#8217;t broken anything.  From a shell:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">docutils</span><span class="o">/</span><span class="n">test</span>
<span class="o">./</span><span class="n">alltests</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
</div>
<div class="section" id="python-versions">
<h2><a class="toc-backref" href="#id7">Python Versions</a><a class="headerlink" href="#python-versions" title="Permalink to this headline">¶</a></h2>
<p>The Docutils 0.10 release supports Python 2.4 or later. Therefore, you should
actually have Pythons 2.4, as well as the latest Python (3.2 at the time
of this writing) installed and always run the tests on all of them.  (A good
way to do that is to always run the test suite through a short script that
runs <code class="docutils literal"><span class="pre">alltests.py</span></code> under each version of Python.) If you can&#8217;t afford
installing 3 or more Python versions, the edge cases (2.4, and 3.2) should
cover most of it.</p>
<p>Good resources covering the differences between Python versions:</p>
<ul class="simple">
<li><a class="reference external" href="http://www.python.org/doc/2.4.4/whatsnew/whatsnew24.html">What&#8217;s New in Python 2.4</a></li>
<li><a class="reference external" href="http://www.python.org/doc/2.5.2/whatsnew/whatsnew25.html">What&#8217;s New in Python 2.5</a></li>
<li><a class="reference external" href="http://docs.python.org/whatsnew/2.6.html">What&#8217;s New in Python 2.6</a></li>
<li><a class="reference external" href="http://www.python.org/peps/pep-0290.html">PEP 290 - Code Migration and Modernization</a></li>
</ul>
</div>
<div class="section" id="unit-tests">
<h2><a class="toc-backref" href="#id8">Unit Tests</a><a class="headerlink" href="#unit-tests" title="Permalink to this headline">¶</a></h2>
<p>Unit tests test single functions or modules (i.e. whitebox testing).</p>
<p>If you are implementing a new feature, be sure to write a test case
covering its functionality.  It happens very frequently that your
implementation (or even only a part of it) doesn&#8217;t work with an older
(or even newer) Python version, and the only reliable way to detect
those cases is using tests.</p>
<p>Often, it&#8217;s easier to write the test first and then implement the
functionality required to make the test pass.</p>
<div class="section" id="writing-new-tests">
<h3><a class="toc-backref" href="#id9">Writing New Tests</a><a class="headerlink" href="#writing-new-tests" title="Permalink to this headline">¶</a></h3>
<p>When writing new tests, it very often helps to see how a similar test
is implemented.  For example, the files in the
<code class="docutils literal"><span class="pre">test_parsers/test_rst/</span></code> directory all look very similar.  So when
adding a test, you don&#8217;t have to reinvent the wheel.</p>
<p>If there is no similar test, you can write a new test from scratch
using Python&#8217;s <code class="docutils literal"><span class="pre">unittest</span></code> module.  For an example, please have a
look at the following imaginary <code class="docutils literal"><span class="pre">test_square.py</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/env python</span>

<span class="c1"># $Id$</span>
<span class="c1"># Author: Your Name &lt;your_email_address@example.org&gt;</span>
<span class="c1"># Copyright: This module has been placed in the public domain.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Test module for docutils.square.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">docutils.square</span>


<span class="k">class</span> <span class="nc">SquareTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">test_square</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">docutils</span><span class="o">.</span><span class="n">square</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">docutils</span><span class="o">.</span><span class="n">square</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="mi">25</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">docutils</span><span class="o">.</span><span class="n">square</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="mi">49</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_square_root</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">docutils</span><span class="o">.</span><span class="n">square</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">49</span><span class="p">),</span> <span class="mi">7</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">docutils</span><span class="o">.</span><span class="n">square</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">docutils</span><span class="o">.</span><span class="n">square</span><span class="o">.</span><span class="n">SquareRootError</span><span class="p">,</span>
                          <span class="n">docutils</span><span class="o">.</span><span class="n">square</span><span class="o">.</span><span class="n">sqrt</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>For more details on how to write tests, please refer to the
documentation of the <code class="docutils literal"><span class="pre">unittest</span></code> module.</p>
</div>
</div>
<div class="section" id="functional-tests">
<span id="functional"></span><h2><a class="toc-backref" href="#id10">Functional Tests</a><a class="headerlink" href="#functional-tests" title="Permalink to this headline">¶</a></h2>
<p>The directory <code class="docutils literal"><span class="pre">test/functional/</span></code> contains data for functional tests.</p>
<p>Performing functional testing means testing the Docutils system as a
whole (i.e. blackbox testing).</p>
<div class="section" id="directory-structure">
<h3><a class="toc-backref" href="#id11">Directory Structure</a><a class="headerlink" href="#directory-structure" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">functional/</span></code> The main data directory.<ul>
<li><code class="docutils literal"><span class="pre">input/</span></code> The input files.<ul>
<li><code class="docutils literal"><span class="pre">some_test.txt</span></code>, for example.</li>
</ul>
</li>
<li><code class="docutils literal"><span class="pre">output/</span></code> The actual output.<ul>
<li><code class="docutils literal"><span class="pre">some_test.html</span></code>, for example.</li>
</ul>
</li>
<li><code class="docutils literal"><span class="pre">expected/</span></code> The expected output.<ul>
<li><code class="docutils literal"><span class="pre">some_test.html</span></code>, for example.</li>
</ul>
</li>
<li><code class="docutils literal"><span class="pre">tests/</span></code> The config files for processing the input files.<ul>
<li><code class="docutils literal"><span class="pre">some_test.py</span></code>, for example.</li>
<li><code class="docutils literal"><span class="pre">_default.py</span></code>, the <a class="reference internal" href="#default-configuration-file">default configuration file</a>.</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="the-testing-process">
<h3><a class="toc-backref" href="#id12">The Testing Process</a><a class="headerlink" href="#the-testing-process" title="Permalink to this headline">¶</a></h3>
<p>When running <code class="docutils literal"><span class="pre">test_functional.py</span></code>, all config files in
<code class="docutils literal"><span class="pre">functional/tests/</span></code> are processed.  (Config files whose names begin
with an underscore are ignored.)  The current working directory is
always Docutils&#8217; main test directory (<code class="docutils literal"><span class="pre">test/</span></code>).</p>
<p>For example, <code class="docutils literal"><span class="pre">functional/tests/some_test.py</span></code> could read like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Source and destination file names.</span>
<span class="n">test_source</span> <span class="o">=</span> <span class="s2">&quot;some_test.txt&quot;</span>
<span class="n">test_destination</span> <span class="o">=</span> <span class="s2">&quot;some_test.html&quot;</span>

<span class="c1"># Keyword parameters passed to publish_file.</span>
<span class="n">reader_name</span> <span class="o">=</span> <span class="s2">&quot;standalone&quot;</span>
<span class="n">parser_name</span> <span class="o">=</span> <span class="s2">&quot;rst&quot;</span>
<span class="n">writer_name</span> <span class="o">=</span> <span class="s2">&quot;html&quot;</span>
<span class="n">settings_overrides</span><span class="p">[</span><span class="s1">&#39;output-encoding&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;utf-8&#39;</span>
<span class="c1"># Relative to main ``test/`` directory.</span>
<span class="n">settings_overrides</span><span class="p">[</span><span class="s1">&#39;stylesheet_path&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;../docutils/writers/html4css1/html4css1.css&#39;</span>
</pre></div>
</div>
<p>The two variables <code class="docutils literal"><span class="pre">test_source</span></code> and <code class="docutils literal"><span class="pre">test_destination</span></code> contain the
input file name (relative to <code class="docutils literal"><span class="pre">functional/input/</span></code>) and the output
file name (relative to <code class="docutils literal"><span class="pre">functional/output/</span></code> and
<code class="docutils literal"><span class="pre">functional/expected/</span></code>).  Note that the file names can be chosen
arbitrarily.  However, the file names in <code class="docutils literal"><span class="pre">functional/output/</span></code> <em>must</em>
match the file names in <code class="docutils literal"><span class="pre">functional/expected/</span></code>.</p>
<p>If defined, <code class="docutils literal"><span class="pre">_test_more</span></code> must be a function with the following
signature:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">_test_more</span><span class="p">(</span><span class="n">expected_dir</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">,</span> <span class="n">test_case</span><span class="p">,</span> <span class="n">parameters</span><span class="p">):</span>
</pre></div>
</div>
<p>This function is called from the test case to perform tests beyond the
simple comparison of expected and actual output files.</p>
<p><code class="docutils literal"><span class="pre">test_source</span></code> and <code class="docutils literal"><span class="pre">test_destination</span></code> are removed from the
namespace, as are all variables whose names begin with an underscore
(&#8220;_&#8221;).  The remaining names are passed as keyword arguments to
<code class="docutils literal"><span class="pre">docutils.core.publish_file</span></code>, so you can set reader, parser, writer
and anything else you want to configure.  Note that
<code class="docutils literal"><span class="pre">settings_overrides</span></code> is already initialized as a dictionary <em>before</em>
the execution of the config file.</p>
</div>
<div class="section" id="creating-new-tests">
<h3><a class="toc-backref" href="#id13">Creating New Tests</a><a class="headerlink" href="#creating-new-tests" title="Permalink to this headline">¶</a></h3>
<p>In order to create a new test, put the input test file into
<code class="docutils literal"><span class="pre">functional/input/</span></code>.  Then create a config file in
<code class="docutils literal"><span class="pre">functional/tests/</span></code> which sets at least input and output file names,
reader, parser and writer.</p>
<p>Now run <code class="docutils literal"><span class="pre">test_functional.py</span></code>.  The test will fail, of course,
because you do not have an expected output yet.  However, an output
file will have been generated in <code class="docutils literal"><span class="pre">functional/output/</span></code>.  Check this
output file for validity and correctness.  Then copy the file to
<code class="docutils literal"><span class="pre">functional/expected/</span></code>.</p>
<p>If you rerun <code class="docutils literal"><span class="pre">test_functional.py</span></code> now, it should pass.</p>
<p>If you run <code class="docutils literal"><span class="pre">test_functional.py</span></code> later and the actual output doesn&#8217;t
match the expected output anymore, the test will fail.</p>
<p>If this is the case and you made an intentional change, check the
actual output for validity and correctness, copy it to
<code class="docutils literal"><span class="pre">functional/expected/</span></code> (overwriting the old expected output), and
commit the change.</p>
</div>
<div class="section" id="the-default-configuration-file">
<span id="default-configuration-file"></span><h3><a class="toc-backref" href="#id14">The Default Configuration File</a><a class="headerlink" href="#the-default-configuration-file" title="Permalink to this headline">¶</a></h3>
<p>The file <code class="docutils literal"><span class="pre">functional/tests/_default.py</span></code> contains default settings.
It is executed just before the actual configuration files, which has
the same effect as if the contents of <code class="docutils literal"><span class="pre">_default.py</span></code> were prepended
to every configuration file.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
      Last updated on Jun 02, 2016.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> | Created By <a href="http://austinvernsonger.com">Austin Vern Songer</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>